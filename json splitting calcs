import json
import os

p1l = 1
p1r = 1
left_hand = 1
right_hand = 1

def prepare_JSON_files(file_name="q_learning_values_for_bot.json"):
    import os

    data = {}

    # --- The crucial part: Getting the script's actual directory ---
    # 1. os.path.abspath(__file__): Gets the absolute path of the current script file (e.g., C:\Users\T\Python projects\current_chopsticks_project\CWD test.py)
    # 2. os.path.dirname(...): Extracts the directory part from that path (e.g., C:\Users\T\Python projects\current_chopsticks_project\)
    script_directory = os.path.dirname(os.path.abspath(__file__))

    # Construct the full path for the new JSON file
    full_file_path = os.path.join(script_directory, file_name)

    print(f"The script is located in: {script_directory}")
    print(f"Attempting to create file at: {full_file_path}")

    try:
        with open(full_file_path, "w") as f:
            json.dump(data, f, indent=4)
        print(f"File '{file_name}' created successfully at the specified path.")

    except IOError as e:
        print(f"Error creating file: {e}")


file_name = "q_learning_values_for_bot.json"
script_directory = os.path.dirname(os.path.abspath(__file__))
data_json = os.path.join(script_directory, file_name)


if left_hand != 0:
    print("here1")
    right_hand_orginal = right_hand
    for i in range(1,left_hand+1):
        right_hand += 1
        print("3")
        if left_hand != right_hand:
            print("2")
            try:
                game_state = f"{p1l}{p1r}{left_hand}{right_hand_orginal}"
                with open(data_json, "r") as f: #creating new key key value trios or key value pairs if needed
                    data_py = json.load(f)
                    print("Opened file")
                    if game_state not in data_py:
                        data_py[game_state] = {}
                    move_choice = f"{left_hand}{right_hand_orginal} {i}"
                    if move_choice not in data_py[game_state]:
                        data_py[game_state][move_choice] = {}
                with open(data_json, "w") as f: #writing it to the json file
                    json.dump(data_py, f, indent=4)
                    print("Successfuly uploaded data_py")
            except json.JSONDecodeError as e:
                print("Error decoding json:", e)
            except KeyError as e:
                print("Error: key not found during access:", e)
            except Exception as e:
                print(f"An error {e} occured")
